# AWS SCP

## 定义

AWS SCP 即 AWS 服务控制策略（Service Control Policies），它是 AWS Organizations 中的一项功能。AWS Organizations 允许用户在
AWS 上创建和管理多个账户，形成一个账户集合。而 SCP 就是用于在这个账户集合层面控制权限的一种策略，它可以限制成员账户中的 IAM
实体（用户、角色）能够执行的 AWS 服务操作，帮助企业更好地管理和控制其 AWS 环境中的资源访问权限。

## 工作原理

### 策略附加

SCP 是以 JSON 格式编写的策略文档，定义了允许或拒绝的操作。这些策略可以附加到 AWS Organizations
中的不同实体上，包括组织根（Root）、组织单元（OU）和单个账户。当一个 SCP 附加到某个实体后，它会影响该实体及其下属所有账户中的
IAM 实体的权限。
例如，如果将一个 SCP 附加到组织根，那么该组织下的所有账户都会受到这个 SCP 的影响；如果附加到某个组织单元，那么该组织单元内的所有账户以及下属组织单元内的账户都会受到影响。

### 权限评估

在评估 IAM 实体（用户或角色）是否具有执行某个 AWS 操作的权限时，AWS 会同时考虑 IAM 策略（如用户或角色本身的权限策略）和
SCP。SCP 作为一种边界策略，会对 IAM 策略进行限制。也就是说，即使 IAM 策略授予了某个操作的权限，但如果 SCP 拒绝了该操作，那么
IAM 实体仍然无法执行该操作。
例如，一个用户的 IAM 策略允许其创建 EC2 实例，但如果附加的 SCP 拒绝了创建 EC2 实例的操作，那么该用户实际上无法创建 EC2 实例。

### 生效逻辑

SCP 遵循“显式拒绝优先”原则，即如果 SCP 中明确拒绝了某个操作，那么无论 IAM 策略如何设置，该操作都将被禁止。同时，SCP
中的允许语句只是定义了一个权限边界，实际的权限还需要 IAM 策略来具体授予。只有当 SCP 允许且 IAM 策略也授予了相应权限时，IAM
实体才能执行该操作。

## 核心优势

### 集中化权限管理

通过 SCP，企业可以在 AWS Organizations 层面集中管理多个账户的权限，而不需要在每个账户中单独配置 IAM
策略。这大大简化了权限管理的复杂度，提高了管理效率。

### 强化安全控制

SCP 可以帮助企业实施严格的安全策略，防止成员账户中的 IAM 实体执行高风险操作。例如，可以通过 SCP
禁止账户删除重要的资源、创建不必要的服务等，从而降低安全风险。

### 符合合规要求

许多行业和法规对数据安全和访问控制有严格的要求。SCP 可以帮助企业确保其 AWS 环境符合这些合规要求，通过精确控制账户的权限，满足合规性审计的需求。

## 应用场景

### 企业多账户环境管理

对于拥有多个 AWS 账户的企业，不同的账户可能用于不同的业务部门或项目。通过 SCP，可以对每个账户或账户组进行权限控制，确保各个部门只能访问其所需的
AWS 服务和资源，避免资源滥用和安全漏洞。

### 新账户创建与权限初始化

当企业创建新的 AWS 账户时，可以通过将预先定义好的 SCP 附加到新账户，快速为其设置合适的权限边界。这样可以确保新账户从一开始就遵循企业的安全策略和最佳实践。

### 安全策略调整与更新

随着企业业务的发展和安全需求的变化，可能需要对账户的权限进行调整。通过修改和更新 SCP，可以快速、统一地调整多个账户的权限，而不需要在每个账户中逐个修改
IAM 策略。 